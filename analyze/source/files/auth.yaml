events:
  - name: ssh_failure
    indicator: SSH authentication failure
    pattern: >
      Failed\s+(password|publickey)\s+for\s+(?P<user>\S+)
      \s+from\s+(?P<ip>\S+)
    message_template: "Failed SSH login for user {user} from {ip}"
    meta_fields: [user, ip]
    filenames:
      - /files_and_dirs/var/log/secure
      - /files_and_dirs/var/log/auth.log
      - /files_and_dirs/var/log/syslog
      # Support non collection source like disk
      - /var/log/secure
      - /var/log/auth.log
      - /var/log/syslog
      # Sample syntax to allow testing directly from local path /var/log/
      - /secure
      - /auth.log
      - /syslog

  - name: ssh_success
    indicator: SSH login success
    pattern: >
      Accepted\s+(password|publickey)\s+for\s+(?P<user>\S+)
      \s+from\s+(?P<ip>\S+)
    message_template: "Successful SSH login for user {user} from {ip}"
    meta_fields: [user, ip]
    filenames:
      - /files_and_dirs/var/log/secure
      - /files_and_dirs/var/log/auth.log
      - /files_and_dirs/var/log/syslog
      - /var/log/secure
      - /var/log/auth.log
      - /var/log/syslog
      - /secure
      - /auth.log
      - /syslog

  - name: sudo_failure
    indicator: Sudo authentication failure
    pattern: >
      sudo:\s+pam_unix\(sudo:auth\):\s+authentication\s+failure;
      \s*logname=(?P<logname>\S+)\s+
      uid=(?P<uid>\d+)\s+
      euid=(?P<euid>\d+)\s+
      tty=(?P<tty>\S+)\s+
      ruser=(?P<ruser>\S*)\s+
      rhost=(?P<rhost>\S*)\s*
      user=(?P<user>\S+)
    message_template: "Sudo authentication failed for user {user} on tty {tty}"
    meta_fields: [user, logname, tty, uid, euid, rhost]
    filenames:
      - /files_and_dirs/var/log/secure
      - /files_and_dirs/var/log/auth.log
      - /var/log/secure
      - /var/log/auth.log
      - /secure
      - /auth.log

  - name: sudo_success
    indicator: Sudo command success
    pattern: >
      sudo:\s+pam_unix\(sudo:session\):\s+session\s+opened
      \s+for\s+user\s+\S+\(uid=\d+\)
      \s+by\s+(?P<user>\S+)\(uid=(?P<uid>\d+)\)
    message_template: "Sudo command session opened for user {user} with uid {uid}"
    meta_fields: [user, uid]
    filenames:
      - /files_and_dirs/var/log/secure
      - /files_and_dirs/var/log/auth.log
      - /var/log/secure
      - /var/log/auth.log
      - /secure
      - /auth.log

  - name: desktop_login_failure
    indicator: Desktop authentication failure
    pattern: >
      (gdm|lightdm|login).*authentication\s+failure.*user=(?P<user>\S+)
    message_template: "Failed desktop login for user {user}"
    meta_fields: [user]
    filenames:
      - /files_and_dirs/var/log/auth.log
      - /files_and_dirs/var/log/secure
      - /var/log/auth.log
      - /var/log/secure
      - /auth.log
      - /secure

  - name: failed_su
    indicator: SU authentication failure
    pattern: >
      su:\s+auth\s+failure\s+for\s+user\s+(?P<user>\S+)
    message_template: "Failed SU attempt for user {user}"
    meta_fields: [user]
    filenames:
      - /files_and_dirs/var/log/secure
      - /files_and_dirs/var/log/auth.log
      - /var/log/secure
      - /var/log/auth.log
      - /secure
      - /auth.log
