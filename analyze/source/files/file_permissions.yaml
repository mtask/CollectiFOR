events:
  - name: world_writable_file
    indicator: File is world-writable
    pattern: >
      ^(?P<path>\S+)\s\d\d[6-7]\s+[^l]
    message_template: "World-writable file detected: {path}"
    meta_fields: [path]
    filenames:
      - /file_permissions.txt

  - name: suid_file
    indicator: File has SUID bit set
    pattern: >
      ^(?P<path>/etc/(shadow|gshadow))\s+\d\d[1-7]\s+
    message_template: "SUID file detected: {path}"
    meta_fields: [path]
    filenames:
      - /file_permissions.txt

  - name: world_readable_sensitive_file
    indicator: Sensitive file is world-readable
    pattern: >
      ^(?P<path>/etc/(shadow|gshadow))s+\d\d[1-7]\s+
    message_template: "Sensitive file is world-readable: {path}"
    meta_fields: [path]
    filenames:
      - /file_permissions.txt

  - name: sticky_bit_directory
    indicator: Directory has sticky bit set
    pattern: >
      (?P<path>\S+)\s+\d+\s+drwx.+(w|r)?t\s.+:.+
    message_template: "Directory with sticky bit detected: {path}"
    meta_fields: [path]
    filenames:
      - /file_permissions.txt
