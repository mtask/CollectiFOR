events:
  - name: world_writable_file
    indicator: File is world-writable
    pattern: >
      ^(?P<path>\S+)\s+\d+\s+.*rwx.*w$
    message_template: "World-writable file detected: {path}"
    meta_fields: [path]
    filenames:
      - /file_permissions.txt

  - name: suid_file
    indicator: File has SUID bit set
    pattern: >
      ^(?P<path>\S+)\s+\d+\s+-rws.*$
    message_template: "SUID file detected: {path}"
    meta_fields: [path]
    filenames:
      - /file_permissions.txt

  - name: world_readable_sensitive_file
    indicator: Sensitive file is world-readable
    pattern: >
      ^(?P<path>/etc/(shadow|gshadow))\s+\d+\s+-rw.*r..$
    message_template: "Sensitive file is world-readable: {path}"
    meta_fields: [path]
    filenames:
      - /file_permissions.txt

  - name: sticky_bit_directory
    indicator: Directory has sticky bit set
    pattern: >
      ^(?P<path>\S+)\s+\d+\s+drwx..t..$
    message_template: "Directory with sticky bit detected: {path}"
    meta_fields: [path]
    filenames:
      - /file_permissions.txt
