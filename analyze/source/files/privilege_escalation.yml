events:
  - name: sshd_root_login_allowed
    indicator: Root login allowed in sshd_config
    pattern: >
      ^\s*PermitRootLogin\s+(?P<value>yes|prohibit-password|without-password)
    message_template: "sshd config allows root login: {value}"
    meta_fields: [value]
    filenames:
      - /files_and_dirs/etc/ssh/sshd_config
      - /files_and_dirs/etc/ssh/sshd_config.d/*.conf
      - /etc/ssh/sshd_config
      - /etc/ssh/sshd_config.d/*.conf
      - /sshd_config
      - /sshd_config.d/*.conf

  - name: sshd_password_auth_enabled
    indicator: PasswordAuthentication enabled
    pattern: >
      ^\s*PasswordAuthentication\s+(?P<value>yes)
    message_template: "PasswordAuthentication is enabled: {value}"
    meta_fields: [value]
    filenames:
      - /files_and_dirs/etc/ssh/sshd_config
      - /files_and_dirs/etc/ssh/sshd_config.d/*.conf
      - /etc/ssh/sshd_config
      - /etc/ssh/sshd_config.d/*.conf
      - /sshd_config
      - /sshd_config.d/*.conf

  - name: sudo_nopasswd_detected
    indicator: Sudoers NOPASSWD entry detected
    pattern: >
      ^(?!\#)(?P<value>\S+).*NOPASSWD
    message_template: "Sudoers file contains NOPASSWD entry for {value}"
    meta_fields: [value]
    filenames:
      - /files_and_dirs/etc/sudoers
      - /files_and_dirs/etc/sudoers.d/*
      - /etc/sudoers
      - /etc/sudoers.d/*
      - /sudoers
      - /sudoers.d/*
