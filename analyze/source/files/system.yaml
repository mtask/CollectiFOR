events:
  - name: kernel_panic
    indicator: Kernel panic
    pattern: >
      Kernel\s+panic
    message_template: "Kernel panic detected"
    meta_fields: []
    filenames:
      - /files_and_dirs/var/log/kern.log
      - /files_and_dirs/var/log/messages

  - name: disk_full
    indicator: Disk full
    pattern: >
      .*Filesystem\s+full.*
    message_template: "Disk full event detected"
    meta_fields: []
    filenames:
      - /files_and_dirs/var/log/syslog
      - /files_and_dirs/var/log/messages

  - name: auth_log_rotate
    indicator: Log rotation
    pattern: >
      logrotate\[\d+\]:\s+restarting\s+log\s+service
    message_template: "Log rotation event"
    meta_fields: []
    filenames:
      - /files_and_dirs/var/log/syslog
      - /files_and_dirs/var/log/messages

  - name: package_install
    indicator: Package installed
    pattern: >
      install(?:\s+-\S+)*\s+(?P<package>[^\s-][^\s]*)
    message_template: "Package installed: {package}"
    meta_fields: [package]
    filenames:
      - /files_and_dirs/var/log/dpkg.log
      - /files_and_dirs/var/log/apt/history.log
      - /files_and_dirs/var/log/yum.log

  - name: package_remove
    indicator: Package removed
    pattern: >
      remove(?:\s+-\S+)*\s+(?P<package>[^\s-][^\s]*)
    message_template: "Package removed: {package}"
    meta_fields: [package]
    filenames:
      - /files_and_dirs/var/log/dpkg.log
      - /files_and_dirs/var/log/apt/history.log
      - /files_and_dirs/var/log/yum.log
