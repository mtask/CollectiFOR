{% extends "base.html" %}
{% block content %}
<div class="container-fluid px-4 text-light">
    {% if finding.rule %}
    <h2 class="mb-3">{{ finding.type }} – {{ finding.rule }}</h2>
    {% elif finding.indicator %}
    <h2 class="mb-3">{{ finding.type }} – {{ finding.indicator }}</h2>
    {% else %}
    <h2 class="mb-3">{{ finding.type }}</h2>
    {% endif %}

    <table class="table table-dark table-striped table-sm">
        <tbody>
            <tr>
                <th>Collection</th>
                <td>{{ finding.collection_name }}</td>
            </tr>
            <tr>
                <th>Message</th>
                <td>{{ finding.message }}</td>
            </tr>
            <tr>
                <th>Artifact</th>
                <td>{{ finding.artifact }}</td>
            </tr>
        </tbody>
    </table>

    {% if finding.meta %}
    <h3 class="mt-4">Metadata</h3>
    <table class="table table-dark table-striped table-sm">
        <thead class="table-secondary">
            <tr>
                <th>Key</th>
                <th>Value</th>
            </tr>
        </thead>
        <tbody>
        {% for key, value in finding.meta.items() %}
            <tr>
                <td>{{ key }}</td>
                <td>{{ value }}</td>
            </tr>
        {% endfor %}
        </tbody>
    </table>
    {% else %}
    <p class="text-light">No metadata available.</p>
    {% endif %}
</div>
{% endblock %}
