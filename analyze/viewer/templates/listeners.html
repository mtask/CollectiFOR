{% extends "base.html" %}

{% block content %}
<h2 class="text-light">Listening Services</h2>

<p style="text-align: center;" class="text-light">
  This page shows network listeners detected on the system at collection time.
</p>

{% if entries %}
<table class="table table-dark table-striped table-hover table-sm">
  <thead class="table-secondary">
    <tr>
      <th>Collection</th>
      <th>Protocol</th>
      <th>Port</th>
      <th>Bind</th>
      <th>PID</th>
      <th>Process</th>
      <th>Executable</th>
      <th>systemd</th>
      <th>Related Paths</th>
    </tr>
  </thead>
  <tbody>
{% for e in entries %}
    <tr>
      <td class="text-light">{{ e.collection_name }}</td>
      <td class="text-light">{{ e.protocol }}</td>
      <td class="text-light">{{ e.port }}</td>
      <td class="mono text-light">{{ e.bind }}</td>
      <td class="text-light">{{ e.pid }}</td>
      <td class="text-light">{{ e.process }}</td>
      <td class="mono text-light">{{ e.exec }}</td>
      <td class="mono text-light">{{ e.systemd }}</td>
      <td class="mono text-light">
{% if e.related_paths %}
{{ '\n'.join(e.related_paths.split(' | ')) }}
{% else %}
          â€”
{% endif %}
      </td>
    </tr>
{% endfor %}
  </tbody>
</table>
{% else %}
<p class="text-light">No listener entries found.</p>
{% endif %}

{% endblock %}

