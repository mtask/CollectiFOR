{% extends "base.html" %}
{% block content %}
<h2>Global Search</h2>

<form method="get">
    <input type="text" name="q" value="{{ q }}" placeholder="Search text" size="60">
    <button type="submit">Search</button>
</form>

{% if q %}

<h3>Command Output</h3>
{% if results.commands %}
<table>
<tr><th>Category</th><th>Command</th><th>Output</th></tr>
{% for c in results.commands %}
<tr>
  <td>{{ c.category }}</td>
  <td class="mono">{{ c.commandline }}</td>
  <td class="mono">{{ c.output }}</td>
</tr>
{% endfor %}
</table>
{% else %}
<p>No command matches.</p>
{% endif %}

<h3>Files</h3>
{% if results.files %}
<table>
<tr><th>Path</th><th>Mode</th><th>Owner</th><th>Group</th></tr>
{% for f in results.files %}
<tr>
  <td class="mono">{{ f.filepath }}</td>
  <td>{{ f.mode }}</td>
  <td>{{ f.owner }}</td>
  <td>{{ f.group }}</td>
</tr>
{% endfor %}
</table>
{% else %}
<p>No file matches.</p>
{% endif %}

<h3>Network Packets</h3>
{% if results.packets %}
<table>
<tr><th>#</th><th>Protocol</th><th>Src</th><th>Dst</th><th>Raw</th></tr>
{% for p in results.packets %}
<tr>
  <td>{{ p.packet_number }}</td>
  <td>{{ p.protocol }}</td>
  <td>{{ p.src }}:{{ p.src_port }}</td>
  <td>{{ p.dst }}:{{ p.dst_port }}</td>
  <td class="mono">{{ p.raw_content }}</td>
</tr>
{% endfor %}
</table>
{% else %}
<p>No packet matches.</p>
{% endif %}

<h3>Findings</h3>
{% if results.findings %}
<ul>
{% for f in results.findings %}
<li>
  <a href="/findings/{{ f.id }}">{{ f.type }} â€“ {{ f.message }}</a>
</li>
{% endfor %}
</ul>
{% else %}
<p>No findings.</p>
{% endif %}

{% endif %}
{% endblock %}
