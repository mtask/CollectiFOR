# Store collection results here
outdir: /tmp/out
# Compress collection directory when finished to tar.gz or keep it as directory
compress_collection: true
modules:
  # Capture e.g. network traffic to pcap
  capture:
    # Capture network traffic
    enable_network: false
    # Capture disk image locally or remote. Target disk and host are specified with cli options. Check collect -h.
    enable_disk: false
    # Target interface(s) are specified with cli options. Check collect -h.
    # Capture volatile memory
    enable_memory: false
    # You can ignore settings for modules that you did not enable. For example: enable_network: --module settings--> network:
    network:
      own_thread: true
      # Seconds
      timeout: 60
    disk:
    memory:
      capture_method: lime
      lime:
        # Module not included. You need to build the lime module and provide path to it here.
        path: memory/lime-6.14.0-36-generic.ko
        # Format: lime/raw
        format: lime
  collect:
    # Collect command outputs for the given commands
    enable_commands: true
    # Copy files and directories from the given paths
    enable_files_and_dirs: true
    # Collect checksums for the given paths
    enable_checksums: true
    # Find luks devices and collect luksDump
    enable_luks: true
    # Collect file permissions for the given paths
    enable_file_permissions: true
    # Collect details about network listening processes
    enable_listeners: true
    # Luks - no additional configuration.
    luks:
    # Command outputs
    # Commands do not need to work/exist on the target. Collection handles non-existent commands cleanly.
    commands:
      list:
      - ps auxwwwef
      - aa-status
      - systemctl list-units --type=service --all
      - systemctl list-timers --all
      - systemctl status                 # general system status
      - aa-status                        # AppArmor status (if installed)
      - service --status-all             # SysV service status (if available)
      # Auditd
      - auditctl -l
      - auditctl -s
      - aureport -i --summary -ts recent
      # Users and login history
      - who
      - w
      - last
      - lastb
      - id
      - groups
      - getent passwd
      - getent shadow
      - getent group
      # Network and connections
      - netstat -tulnpa
      - ss -tulnpa
      - ip addr show
      - ip route show
      - iptables-save
      - iptables -L -n
      - ip6tables -L -n
      - nft list ruleset
      - ufw status verbose
      - firewall-cmd --state
      - firewall-cmd --list-all
      - ip neigh
      - arp -n
      - sshd -T
      # Package / installed software
      - dpkg -l                           # Debian/Ubuntu
      - rpm -qa                           # RHEL/CentOS
      - apt-cache policy                   # Debian package policy
      - yum list installed                 # RHEL package list
      - flatpak list                       # if flatpak is used
      - snap list                          # if snap is used
      # Disk and filesystem
      - df -h
      - mount
      - lsblk -f
      - findmnt
      # Kernel and system info
      - uname -a
      - cat /proc/version
      - dmesg
      - lsmod
      - sysctl -a
      # Docker / containers
      - docker ps -a                       # containers
      - "docker ps -a | awk '{print $1}'|grep -v CONTAINER |xargs -n1 docker inspect"
      - "docker network ls | awk '{print $1}'|grep -v NETWORK |xargs -n1 docker network inspect"
      - docker images                      # images
      - docker info
      - kubectl get pods --all-namespaces
    # Files and directories to collect
    # Full copies are taken to collection
    # Wildcard expansion is supported
    # Paths do not need to exists on the target system. Non-existent paths are just ignored.
    files_and_dirs:
      list:
      - /proc/version
      - /proc/cmdline
      - /proc/modules
      - /lib/systemd/system
      - /var/spool/cron/crontabs
      - /etc/
      - /root/.ssh
      - /home/*/.ssh
      - /root/.bash_history
      - /root/.zsh_history
      - /home/*/.bash_history
      - /home/*/.zsh_history
      - /var/lib/dpkg/status
      - /var/lib/rpm
      - /var/www/
      - /var/log/
      - /opt
      - /srv
      # Docker/Kubernetes (if present)
      #- /var/lib/docker
      #- /var/lib/kubelet
      # Key binaries and scripts
      #- /usr/bin
      #- /usr/local/bin
      #- /bin
      #- /sbin
      #- /usr/sbin
      # Temp files (possible malware drops)
      #- /tmp
      #- /var/tmp
    # Collects checksums for the given file paths
    # Directories are always recursive
    checksums:
      list:
      - /etc/
      - /usr/bin
      - /usr/local/bin
      - /bin
      - /sbin
      - /usr/sbin
      #- /lib64
      #- /lib
      #- /usr/lib64
      #- /usr/lib
      #- /var/lib
    # Collect file permissions for the given paths
    # Directories are always recursive
    file_permissions:
      list:
      - /etc/
    # Collect information about network processes - no addittional configuration
    listeners:
